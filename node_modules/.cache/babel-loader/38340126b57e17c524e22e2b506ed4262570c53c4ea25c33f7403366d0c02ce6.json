{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/rafae/OneDrive/\\xC1rea de Trabalho/REACT/myapp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/rafae/OneDrive/\\xC1rea de Trabalho/REACT/myapp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/rafae/OneDrive/\\xC1rea de Trabalho/REACT/myapp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./admin.css';import{useState,useEffect}from'react';import{signOut}from'firebase/auth';import{auth,db}from'../../firebaseConnection';import{addDoc,collection,query,where,onSnapshot,orderBy,doc,deleteDoc,updateDoc}from'firebase/firestore';import{async}from'@firebase/util';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Admin(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),task=_useState2[0],setTask=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),editTarefa=_useState6[0],setEditTarefa=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),tarefasOn=_useState8[0],setTarefasOn=_useState8[1];useEffect(function(){function loadTasks(){return _loadTasks.apply(this,arguments);}function _loadTasks(){_loadTasks=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var userDetails,data,taskRef,q,snap;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:userDetails=localStorage.getItem(\"@detailsUser\");setUser(JSON.parse(userDetails));if(userDetails){data=JSON.parse(userDetails);taskRef=collection(db,'tasks');/*           buscar /aqui / por ordem decrescente de data / onde dado de 'usuário' seja igual ao uid do logado atual  */q=query(taskRef,orderBy('data','desc'),where('usuário','==',data===null||data===void 0?void 0:data.uid));snap=onSnapshot(q,function(snapshot){var list=[];snapshot.forEach(function(doc){list.push({userUid:doc.data().usuário,tasks:doc.data().tarefa,id:doc.id});});setTarefasOn(list);});}case 3:case\"end\":return _context.stop();}},_callee);}));return _loadTasks.apply(this,arguments);}loadTasks();},[]);function handleRegistrer(_x){return _handleRegistrer.apply(this,arguments);}function _handleRegistrer(){_handleRegistrer=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:e.preventDefault();if(!(task==='')){_context2.next=4;break;}alert('DIGITE UMA TAREFA');return _context2.abrupt(\"return\");case 4:if(!(editTarefa!==null&&editTarefa!==void 0&&editTarefa.id)){_context2.next=7;break;}handleUpdate();return _context2.abrupt(\"return\");case 7:_context2.next=9;return addDoc(collection(db,'tasks'),{tarefa:task,data:new Date(),usuário:user===null||user===void 0?void 0:user.uid}).then(function(){console.log('TAREFA ADICIONADA');setTask('');}).catch(function(error){console.log('ERRO AO ADICIONAR TAREFA'+error);});case 9:case\"end\":return _context2.stop();}},_callee2);}));return _handleRegistrer.apply(this,arguments);}function handleLogOut(){return _handleLogOut.apply(this,arguments);}function _handleLogOut(){_handleLogOut=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return signOut(auth);case 2:case\"end\":return _context3.stop();}},_callee3);}));return _handleLogOut.apply(this,arguments);}function deleteTask(_x2){return _deleteTask.apply(this,arguments);}function _deleteTask(){_deleteTask=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(id){var docRef;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:docRef=doc(db,'tasks',id);deleteDoc(docRef);case 2:case\"end\":return _context4.stop();}},_callee4);}));return _deleteTask.apply(this,arguments);}function editTask(item){setEditTarefa(item);setTask(item.tasks);}function handleUpdate(){return _handleUpdate.apply(this,arguments);}function _handleUpdate(){_handleUpdate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var docRef;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:docRef=doc(db,'tasks',editTarefa===null||editTarefa===void 0?void 0:editTarefa.id);_context5.next=3;return updateDoc(docRef,{tarefa:task}).then(function(){console.log(\"TAREFA ATUALIZADA\");setTask('');setEditTarefa({});}).catch(function(error){console.log(error+\"NÃO FOI POSSÍVEL ATUALIZAR\");});case 3:case\"end\":return _context5.stop();}},_callee5);}));return _handleUpdate.apply(this,arguments);}function timeTask(_x3){return _timeTask.apply(this,arguments);}function _timeTask(){_timeTask=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(id){var docRef;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:docRef=doc(db,'tasks',editTarefa===null||editTarefa===void 0?void 0:editTarefa.id);deleteDoc(docRef);case 2:case\"end\":return _context6.stop();}},_callee6);}));return _timeTask.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Minhas Tarefas\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleRegistrer,className:\"form\",children:[/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Digite sua Tarefa\",value:task,onChange:function onChange(e){return setTask(e.target.value);}}),Object.keys(editTarefa).length>0?/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-register\",children:\"Atualizar Tarefa\"}):/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-register\",children:\"Registrar Tarefa\"})]}),tarefasOn.map(function(item){return/*#__PURE__*/_jsxs(\"article\",{className:\"list\",children:[/*#__PURE__*/_jsx(\"p\",{children:item.tasks}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return editTask(item);},className:\"btn-edit\",children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return deleteTask(item.id);},className:\"btn-checked\",children:\"Concluir\"})]})]},item.id);}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-logout\",onClick:handleLogOut,children:\"Sair\"})]});}","map":{"version":3,"names":["useState","useEffect","signOut","auth","db","addDoc","collection","query","where","onSnapshot","orderBy","doc","deleteDoc","updateDoc","async","Admin","task","setTask","user","setUser","editTarefa","setEditTarefa","tarefasOn","setTarefasOn","loadTasks","userDetails","localStorage","getItem","JSON","parse","data","taskRef","q","uid","snap","snapshot","list","forEach","push","userUid","usuário","tasks","tarefa","id","handleRegistrer","e","preventDefault","alert","handleUpdate","Date","then","console","log","catch","error","handleLogOut","deleteTask","docRef","editTask","item","timeTask","target","value","Object","keys","length","map"],"sources":["C:/Users/rafae/OneDrive/Área de Trabalho/REACT/myapp/src/pages/Admin/index.js"],"sourcesContent":["import './admin.css'\r\nimport {useState, useEffect} from 'react'\r\nimport {signOut,} from 'firebase/auth'\r\nimport {auth ,db} from '../../firebaseConnection'\r\nimport {addDoc, collection, query, where, onSnapshot, orderBy, doc, deleteDoc, updateDoc} from 'firebase/firestore'\r\nimport { async } from '@firebase/util'\r\n\r\nexport default function Admin() {\r\n    const [task, setTask] = useState('')\r\n    const [user, setUser] = useState({})\r\n    const [editTarefa, setEditTarefa] = useState({})\r\n    const [tarefasOn, setTarefasOn] = useState([])\r\n    \r\n    useEffect(()=>{\r\n      async function loadTasks(){\r\n        const userDetails = localStorage.getItem(\"@detailsUser\")\r\n        setUser(JSON.parse(userDetails))\r\n\r\n        if(userDetails) {\r\n          const data = JSON.parse(userDetails)\r\n\r\n          const taskRef = collection(db, 'tasks')\r\n       /*           buscar /aqui / por ordem decrescente de data / onde dado de 'usuário' seja igual ao uid do logado atual  */\r\n          const q = query(taskRef, orderBy('data', 'desc'), where('usuário', '==', data?.uid))\r\n          const snap = onSnapshot(q, (snapshot) => {\r\n            let list = []\r\n\r\n            snapshot.forEach((doc)=>{\r\n              list.push({\r\n                userUid: doc.data().usuário,\r\n                tasks: doc.data().tarefa,\r\n                id: doc.id\r\n              })\r\n            })\r\n            setTarefasOn(list)\r\n          })\r\n        }\r\n\r\n      }\r\n      loadTasks()\r\n    },[])\r\n    \r\n    async function handleRegistrer(e) {\r\n     e.preventDefault()\r\n\r\n     if(task === ''){\r\n      alert('DIGITE UMA TAREFA')\r\n      return;\r\n     }\r\n\r\n     if(editTarefa?.id){\r\n      handleUpdate()\r\n      return;\r\n     }\r\n\r\n     await addDoc(collection(db,'tasks'),{\r\n      tarefa: task,\r\n      data: new Date(),\r\n      usuário: user?.uid\r\n     })\r\n     .then(()=>{\r\n      console.log('TAREFA ADICIONADA')\r\n      setTask('')\r\n     })\r\n     .catch((error)=>{\r\n      console.log('ERRO AO ADICIONAR TAREFA' + error)\r\n     })\r\n    }\r\n    \r\n    async function handleLogOut() {\r\n     await signOut(auth)\r\n    }\r\n\r\n    async function deleteTask(id) {\r\n      const docRef = doc(db, 'tasks', id)\r\n      deleteDoc(docRef)\r\n    }\r\n\r\n    function editTask(item) {\r\n      setEditTarefa(item)\r\n      setTask(item.tasks)\r\n    }\r\n\r\n    async function handleUpdate(){\r\n      const docRef = doc(db, 'tasks', editTarefa?.id )\r\n     await updateDoc(docRef, {\r\n        tarefa: task\r\n      })\r\n      .then(()=>{\r\n        console.log(\"TAREFA ATUALIZADA\")\r\n        setTask('')\r\n        setEditTarefa({})\r\n      })\r\n      .catch((error)=>{\r\n        console.log(error + \"NÃO FOI POSSÍVEL ATUALIZAR\")\r\n      })\r\n    }\r\n\r\n    async function timeTask(id) {\r\n      const docRef = doc(db, 'tasks', editTarefa?.id )\r\n      deleteDoc(docRef)\r\n    }\r\n\r\n        return(\r\n        <div className='admin-container'>\r\n            <h1>Minhas Tarefas</h1>\r\n\r\n          <form onSubmit={handleRegistrer} className='form'>\r\n            <textarea placeholder='Digite sua Tarefa'\r\n            value={task}\r\n            onChange={(e)=> setTask(e.target.value)} \r\n            />\r\n          \r\n          {Object.keys(editTarefa).length > 0 ?(\r\n            <button type='submit' className='btn-register'>Atualizar Tarefa</button>\r\n          ) : (\r\n            <button type='submit' className='btn-register'>Registrar Tarefa</button>\r\n          )} \r\n          \r\n          </form> \r\n\r\n          {tarefasOn.map( (item) =>(\r\n          <article key={item.id} className='list'>\r\n            <p>{item.tasks}</p>\r\n            <div>\r\n                <button onClick={()=> editTask(item) } className='btn-edit'>Editar</button>\r\n                <button onClick={()=> deleteTask(item.id) } className='btn-checked'>Concluir</button>\r\n            </div>\r\n          </article>\r\n          ))}\r\n          <button className='btn-logout' onClick={handleLogOut}>Sair</button>\r\n        </div>\r\n    )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}